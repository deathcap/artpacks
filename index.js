// Generated by CoffeeScript 1.6.3
(function() {
  var AdmZip, match, nameToPath_RP, readResourcePack, zip;

  AdmZip = require('adm-zip');

  match = require('minimatch');

  readResourcePack = function(zip, names) {
    var found, name, path, paths, zipEntries, zipEntry, _i, _j, _len, _len1, _results;
    zipEntries = zip.getEntries();
    paths = (function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = names.length; _i < _len; _i++) {
        name = names[_i];
        _results.push(nameToPath_RP(name));
      }
      return _results;
    })();
    console.log('PATHS=', paths);
    _results = [];
    for (_i = 0, _len = paths.length; _i < _len; _i++) {
      path = paths[_i];
      found = false;
      for (_j = 0, _len1 = zipEntries.length; _j < _len1; _j++) {
        zipEntry = zipEntries[_j];
        if (match(zipEntry.entryName, path)) {
          console.log('FOUND', path, 'AT', zipEntry.entryName);
          zipEntry.getDataAsync(function(data, err) {
            return console.log("decompressed " + zipEntry.entryName + " to " + data.length + ", err " + err);
          });
          found = true;
        }
      }
      if (!found) {
        _results.push(console.log("ERROR: couldn't find " + path + "!"));
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  };

  nameToPath_RP = function(name) {
    var a, category, ext, namespace, path, _ref;
    a = name.split('/');
    if (a.length > 1) {
      category = a[0], name = a[1];
    }
    category = (_ref = {
      undefined: 'blocks',
      'i': 'items'
    }[category]) != null ? _ref : category;
    a = name.split(':');
    if (a.length > 1) {
      namespace = a[0], name = a[1];
    }
    if (namespace == null) {
      namespace = '*';
    }
    ext = '.png';
    path = "assets/" + namespace + "/textures/" + category + "/" + name + ".png";
    return path;
  };

  console.log(nameToPath_RP('dirt'));

  console.log(nameToPath_RP('i/stick'));

  console.log(nameToPath_RP('misc/shadow'));

  console.log(nameToPath_RP('minecraft:dirt'));

  console.log(nameToPath_RP('somethingelse:dirt'));

  zip = new AdmZip('test.zip');

  readResourcePack(zip, ['dirt', 'i/stick', 'misc/shadow', 'minecraft:dirt', 'somethingelse:dirt']);

}).call(this);
